# doprf-rust
Rust implementation of DOPRF

All of these scripts have help with the -h option.

All script parameters are passed as command line/terminal arguments (some use single-letter switches and some use "--")

After `> cargo build` in root directory, run with cargo run --bin [script name without .rs extension], e.g. `> cargo run --bin genkey`

Arguments: cargo run --bin genkeyshares for example won't work; arguments must be provided after "--", e.g. `> cargo run --bin genkeyshares` -- -h prints help.

# Usage order

- genkey.rs
- genkeyshares.rs
- genhdb.rs
- hdbserver.rs
- keyserver.rs

## genkeyshares.rs

Pass parameters: how many key servers, threshold

```
cargo run --bin genkeyshares -- [key generated by genkey.rs --keyholders-required 3 --num-keyholders 5
```

## genactivesecuritykey.rs
```
cargo run --bin genactivesecuritykey -- [key generated by genkey.rs] --keyholders-required 3 --keyshares [comma separated keyshares generated by geneyshares.rs] 
```

## genhdb.rs

for "generate hash database" (as opposed to metadata database)

## hdbserver.rs

Only run one instance

## keyserver.rs

Run as many instances as are required according to the configured key server number and threshold

```
cargo run --bin keyserver -- --keyshare [keyshare 1] -p 3001 --id [keyserver id] &
cargo run --bin keyserver -- --keyshare [keyshare 2] -p 3002 --id [keyserver id] &
cargo run --bin keyserver -- --keyshare [keyshare 3] -p 3003 --id [keyserver id] &
```

## sdnaclient.rs

Run at least one to answer queries. Multiple may be run simultaneously.

Pass parameter: threshold number of key servers

```
cargo run --bin sdnaclient -- 127.0.0.1:2999 127.0.0.1:3001 127.0.0.1:3002 127.0.0.1:3003 &
```

As noted above, all ports are `<literal IP>:<port>`.

Hangs waiting for stdin.

input format: one plaintext sequence per line (`[sequence1]\n[sequence2]\n`), no whitespace; last entry ends in `\n^D` to indicate end of input. In real usage, Python subprocess.run should automatically terminate with this `^D` character when provided with a file-like object as input. TODO: link docs

**Note: currently the first k keyservers must be contacted, and k must be the exact threshold. Minor; will be corrected soon.**

**Note: must specify IP as 127.0.0.1:3000 or similar, e.g. "localhost" or no port will not work.**
